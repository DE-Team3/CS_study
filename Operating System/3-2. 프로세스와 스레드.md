# PCB
- 운영체제에서 프로세스에 대한 메타데이터를 저장한 데이터를 말합니다 
- 프로세스 제어 블록이라고도 합니다 
- 프로세스가 생성되면 운영체제는 해당 PCB를 생성합니다 

프로세스가 생성되고 프로세스 주소 값들이 스택, 힙 등의 구조를 기반으로 메모리가 할당 됩니다. 프로세스의 메타데이터들이 PCB에 저장되어 관리가 됩니다
보안성 때문에 일반사용자가 접근 못하도록 커널스택의 가장 앞부분에서 관리 됩니다
**메타데이터**
- 데이터의 관한 구조화된 데이터이자 데이터를 설명하는 작은 데이터 
- 대량의 정보 가운데에서 찾고 있는 정보를 찾기에 효울적
- 효율적으로 찾기위해 일정한 규칙에 따라 콘텐츠에 대하여 부여되는 데이터

## 1. PCB구조

![화면 캡처 2022-12-29 001904](https://user-images.githubusercontent.com/108858309/209844482-8039f4fe-465c-4512-9010-80abd3f253aa.png)

PCB 프로세스 스케줄링 상태, 프로세스ID 등이 가음과 같은 정보로 이루어져 있습니다
- **프로세스 스케줄링 상태** : '준비' '일시중단' 등 프로세스가 CPU에 대한 소유권을 얻은 상태
- **프로세스ID** : 프로세스ID 해당 프로세스의 자식프로세스 ID
- **프로세스 권한** : 컴퓨터 자원 또는 I/O 디바이스에 대한 권한 정보
- **프로그램 카운터** : 프로세스에서 실행해야 할 다음 명령어의 주소에 대한 포인터
- **CPU레지스터** : 프로세스를 실행하기 위해 저장해야할 레지스터에 대한 정보
- **CPU스케줄링 정보** : CPU 스케줄러에 의해 중단된 시간 등에 대한 정보
- **계정정보** : 프로세스 실행에 사용된 CPU사용량, 실행한 유저의 정보
- **I/O상태정보** : 프로세스에 할당된 I/O디바이스 목록

## 2. 컨텍스트 스위칭
- PCB를 교환하는 과정을 말합니다 한 프로세스에 할당된 시간이 끝나거나 인터렙트의 의해 발생합니다
- 컴퓨터의 많은 프로그램이 동시에 구동되는 것으로 보이지만 어떠한시점에서 실행되는 프로세스는 한개입니다

**컨텍스트란?**
CPU가 해당 프로세스를 실행하기 위한 해당 프로세스의 정보들을 뜻합니다

![화면 캡처 2022-12-28 211201](https://user-images.githubusercontent.com/108858309/209844564-6c91656d-e0ca-4586-85e0-7d0130fc7dbe.png)

## 2.1 컨텍스트 스위칭 작동순서
위그림처럼 A라는 프로세스가 running 상태이고 B라는 프로세스가 ready 상태라고 할 때
- 스케쥴러가 A프로세스를 실행 중단을 요청 후 B프로세스를 실행요청합니다
- A프로세스가 실행하다 멈추고 A의 PCB를 저장합니다 그후 B프로세서를 로드하여 실행합니다 또 다시 B의 PCB를 저장하고 A PCB를 로드하는것이 스위칭입니다
- 스위칭을할떄 드는 비용이있습니다 (캐시미스)
  - **캐시미스란?** : 캐시의 용량이 부족하여 발생하는 미스이다 즉 프로그램 수행 접근시 데이터양이 캐시의 사이즈를 넘어갈 경우 발생한다

**스레드에서 컨텍스트 스위칭**
- 스위칭은 스레드에서도 일어납니다 스레드는 스택영역을 제외한 모든 메모리를 공유하기 때문에 스위칭의 비용이 적습니다

## 3. 멀리프로세싱
- 멀티프로세싱은 여러개의 프로세스의 동시작업을 뜻하는 말입니다
- 하나이상의 일을 병렬적으로 처리할 수 있으며
- 프로세스 메모리 or 프로세스 중 일부에 문제가 발생하여도 다른프로세스 이용이 가능하다
- 신뢰성이높다

## 3.1 웹 브라우저
- 웹 브라우저는 대표적인 멀티프로세스 구조입니다

![화면 캡처 2022-12-29 003047](https://user-images.githubusercontent.com/108858309/209844739-b692cf1c-0813-435d-a95d-bd77231d4b98.png)

- **브라우저 프로세스** : 주소 표시줄, 북마크 막대, 뒤로가기버튼 등을 담당하며 워크요청이나 파일 접근 같은 권한을 담당합니다
- **렌더러 프로세스** : 웹사이트가 보이는 부분을 모든것을 제어합니다
- **플러그인 프로세스** : 웹사이트에서 사용하는 플러그인을 제어합니다
- **GPU프로세스** : GPU를 이용해서 화면을 그리는 부분을 제어합니다

### IPC
- 멀티프로세스의 기능입니다 
- 프로세스끼리 데이터를 주고받고 공유데이터를 관리하는 메커니즘을 뜻합니다

### 공유메모리
- 공유메모리는 여러 프로세스에 동일한 메모리 블록에 대한 접근 권한이 부여되어 프로세스가 서로 통신할수있는 버퍼를 생성하는것을 말합니다

![화면 캡처 2022-12-29 005324](https://user-images.githubusercontent.com/108858309/209844773-c1a807ef-f0d6-4697-a23e-361887d2fe2c.png)

위 사진은 일반적인 메모리입니다 보이시는 것 처럼 1:1의 관계를 보이고있습니다

![화면 캡처 2022-12-29 005342](https://user-images.githubusercontent.com/108858309/209844781-5b09d284-0463-4bd8-b3dc-a5eae342a40d.png)

위 사진이 공유메모리의 관계입니다 1:n의 관계를 보입니다
- 일반적인 메모리보다 좋은점은 메모리자체를 공유하기떄문에 데이터복사 같은 오버헤드가 발생하지않아 매우 빠릅니다
- 메모리 영역을 모든 프로세스가 공유하기때문에 동기화가 필요합니다 

### 파일
- 디스크에 저장된 데이터 또는 파일 서버에서 제공한 데이터를 말합니다 이를 기반으로 프로세스 간 통신을 합니다

### 소켓
- 동일한 컴퓨터의 다른 프로세스나 네트워크의 다른 컴퓨터로 네트워크 인터페이스를 통해 전송하는 데이터를 의미합니다 (TCP와 UDP)

### 익명 파이프

![화면 캡처 2022-12-29 010859](https://user-images.githubusercontent.com/108858309/209844821-8de50dbd-7e89-4032-9655-e9b40bd14e6d.png)

- 익명 파이프는 프로세스 간에 FIFO 방식으로 읽히는 임시 공간인 파이프를 기반으로 데이터를 주고받습니다
- 한쪽에서 쓰기를 하면 다른 쪽에서 읽기를 하는 방식으로 통신합니다
- 부모, 자식 프로세스 간에만 사용할 수 있습니다

### 명명된 파이프

![화면 캡처 2022-12-29 010913](https://user-images.githubusercontent.com/108858309/209844853-56274f62-4f14-4878-832f-4b73f49bf476.png)

- 명명된 파이프는 파이프 서버와 하나 이상의 파이프 클라이언트 간의 통신을 위한 명명된 단방향 또는 이중 파이프를 말합니다
- 여러 파이프를 동시에 사용 할수도 있습니다
- 컴퓨터의 프로세스끼리 또 다른 네트워크상의 컴퓨터랑도 통신이 가능합니다
- 서버용 파이프와 클라이언트용 파이프로 구분하여 작동합니다

### 메세지 큐
- 메세지를 큐 데이터 구조 형태로 관리하는 것을 말한다 MQ라고도 부릅니다
- 커널에서 전역적으로 관리되며 다른 IPC 방식에 비해서 사용 방법이 매우 직관적이고 간단하다 
- 다른코드 수정없이 단지 몇 줄의 코드를 추가시켜 간단하게 메세지 큐에 접근할 수 있는 장점이있습니다

## 4. 스레드와 멀티스레딩

### 스레드
- 스레드는 프로세스의 실행가능한 가장 작은단위 입니다
- 스레드는 여러 프로세스를 가질수 있습니다

![화면 캡처 2022-12-29 013123](https://user-images.githubusercontent.com/108858309/209844877-76133642-382a-4997-88ee-7b31e599f1e8.png)

- 하나의 프로세스에 존재하는 스레드들은 코드, 데이터, 힙영역 과 같은 메모리 자원을 공유, 스택영역이 독립적으로 할당된 구조

### 멀티스레딩
- 멀티스레딩은 프로세스내 작업을 여러 개의 스레드로 처리하는 기법입니다
- 스레기끼리 자원을 공유하기 때문에 효율성이 높습니다
  - **장점**
    - 프로세스 내 자원들이 메모리를 공유해 자원소모를 줄입니다
    - 한 스레드가 중단 되어도 다른 스레드는 작동하기에 중단없이 빠른 실행이 가능합니다
    - 동시성에도 큰 장점이 있습니다
  - **단점**
    - 자원을 공유하기에 동기화 문제가 발생할수있습니다
    - 하나의 스레드에 문제가 생기면 전체 프로세스가 영향을 받습니다 



**참고자료**
- https://hyunie-y.tistory.com/31
- https://lolki.tistory.com/2
- http://www.tipssoft.com/bulletin/board.php?bo_table=story&wr_id=13616
